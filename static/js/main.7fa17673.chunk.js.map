{"version":3,"sources":["App.js","index.js"],"names":["App","props","goBack","history","state","pop","activePanel","length","bridge","send","setState","goForward","push","error","isLoaded","weather","forecast","lat","long","then","data","error_type","fetch","res","json","result","daily","slice","catch","this","onSwipeBack","id","message","React","Component","ReactDOM","render","document","getElementById"],"mappings":"gOAmIeA,E,kDA7HX,WAAYC,GAAQ,IAAD,8BACf,cAAMA,IA6DVC,OAAS,WACX,IAAMC,EAAO,YAAO,EAAKC,MAAMD,SAC/BA,EAAQE,MACR,IAAMC,EAAcH,EAAQA,EAAQI,OAAS,GACzB,SAAhBD,GACFE,IAAOC,KAAK,2BAEd,EAAKC,SAAS,CAAEP,UAASG,iBArEJ,EAwEtBK,UAAY,SAACL,GACZ,IAAMH,EAAO,YAAO,EAAKC,MAAMD,SAC/BA,EAAQS,KAAKN,GACkB,SAA3B,EAAKF,MAAME,aACbE,IAAOC,KAAK,4BAEd,EAAKC,SAAS,CAAEP,UAASG,iBA5EnB,EAAKF,MAAQ,CACTS,MAAO,KACPC,UAAU,EACVC,QAAS,GACTC,SAAU,GACVV,YAAa,OACbH,QAAS,CAAC,SARC,E,qDAYnB,WAAqB,IAAD,OACZc,EAAM,EACNC,EAAO,EACXV,IAAOC,KAAK,sBACHU,MAAK,SAAAC,GACqB,gBAAnBA,EAAKC,YACLJ,EAAM,GACNC,EAAO,KAGPD,EAAMG,EAAKH,IACXC,EAAOE,EAAKF,MAEhBI,MAAM,uDAAwDL,EAAK,QAAUC,EAAO,gEAC/EC,MAAK,SAAAI,GAAG,OAAIA,EAAIC,UAChBL,MAAK,SAACM,GACH,EAAKf,SAAS,CACVK,QAASU,OAGjB,SAACZ,GACG,EAAKH,SAAS,CACVI,UAAU,EACVD,aAGZS,MAAM,uDAAwDL,EAAK,QAAUC,EAAO,gEAC/EC,MAAK,SAAAI,GAAG,OAAIA,EAAIC,UAChBL,MAAK,SAACM,GACH,EAAKf,SAAS,CACVI,UAAU,EACVE,SAAUS,EAAOC,MAAMC,MAAM,QAGrC,SAACd,GACG,EAAKH,SAAS,CACVI,UAAU,EACVD,gBAKfe,OAAM,SAAAf,GACH,EAAKH,SAAS,CACVI,UAAU,EACVD,e,oBAwBpB,WAAU,IAAD,EACuBgB,KAAKzB,MAAzBS,EADH,EACGA,MAAOC,EADV,EACUA,SACf,OAAID,EAEI,kBAAC,IAAD,CACIiB,YAAaD,KAAK3B,OAClBC,QAAS0B,KAAKzB,MAAMD,QACpBG,YAAauB,KAAKzB,MAAME,aAExB,kBAAC,IAAD,CAAOyB,GAAG,QACN,kBAAC,IAAD,6CACA,6BAAMlB,EAAMmB,WAIlBlB,EAcF,kBAAC,IAAD,CACXgB,YAAaD,KAAK3B,OAClBC,QAAS0B,KAAKzB,MAAMD,QACpBG,YAAauB,KAAKzB,MAAME,aAET,kBAAC,IAAD,CAAOyB,GAAG,QACN,oCAlBR,kBAAC,IAAD,CACID,YAAaD,KAAK3B,OAClBC,QAAS0B,KAAKzB,MAAMD,QACpBG,YAAauB,KAAKzB,MAAME,aAExB,kBAAC,IAAD,CAAOyB,GAAG,QACN,kBAAC,IAAD,kE,GAzGNE,IAAMC,WCCxB1B,IAAOC,KAAK,gBAEZ0B,IAASC,OAAO,kBAAC,EAAD,MAASC,SAASC,eAAe,W","file":"static/js/main.7fa17673.chunk.js","sourcesContent":["import React from 'react';\r\nimport bridge from '@vkontakte/vk-bridge';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport { Panel, View, PanelHeader } from '@vkontakte/vkui';\r\n\r\nclass App extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            error: null,\r\n            isLoaded: false,\r\n            weather: '',\r\n            forecast: '',\r\n            activePanel: 'main',\r\n            history: ['main']\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        let lat = 0;\r\n        let long = 0;\r\n        bridge.send('VKWebAppGetGeodata')\r\n                .then(data => {\r\n                    if (data.error_type == 'client_error') {\r\n                        lat = 30;\r\n                        long = 50;\r\n                    }\r\n                    else {\r\n                        lat = data.lat;\r\n                        long = data.long;\r\n                    }\r\n                    fetch(\"https://api.openweathermap.org/data/2.5/weather?lat=\"+ lat +\"&lon=\" + long + \"&units=metric&lang=ru&appid=e937bb61987a79d09b7604a3375a9941\")\r\n                        .then(res => res.json())\r\n                        .then((result) => {\r\n                            this.setState({ \r\n                                weather: result\r\n                            });\r\n                        },\r\n                        (error) => {\r\n                            this.setState({\r\n                                isLoaded: true,\r\n                                error\r\n                            });\r\n                        })\r\n                    fetch(\"https://api.openweathermap.org/data/2.5/onecall?lat=\"+ lat +\"&lon=\" + long + \"&units=metric&lang=ru&appid=e937bb61987a79d09b7604a3375a9941\")\r\n                        .then(res => res.json())\r\n                        .then((result) => {\r\n                            this.setState({\r\n                                isLoaded: true,\r\n                                forecast: result.daily.slice(1)\r\n                            });\r\n                        },\r\n                        (error) => {\r\n                            this.setState({\r\n                                isLoaded: true,\r\n                                error\r\n                            });\r\n                        }\r\n                    )\r\n                })\r\n                .catch(error => {\r\n                    this.setState({ \r\n                        isLoaded: true,\r\n                        error\r\n                    });\r\n                });\r\n    }\r\n\r\n    goBack = () => {\r\n\t\tconst history = [...this.state.history];\r\n\t\thistory.pop();\r\n\t\tconst activePanel = history[history.length - 1];\r\n\t\tif (activePanel === 'main') {\r\n\t\t  bridge.send('VKWebAppEnableSwipeBack');\r\n\t\t}\r\n\t\tthis.setState({ history, activePanel });\r\n\t}\r\n\t\r\n\tgoForward = (activePanel) => {\r\n\t\tconst history = [...this.state.history];\r\n\t\thistory.push(activePanel);\r\n\t\tif (this.state.activePanel === 'main') {\r\n\t\t  bridge.send('VKWebAppDisableSwipeBack');\r\n\t\t}\r\n\t\tthis.setState({ history, activePanel });\r\n\t}\r\n\r\n    render() {\r\n        const { error, isLoaded } = this.state;\r\n        if (error) {\r\n            return (\r\n                <View\r\n                    onSwipeBack={this.goBack}\r\n                    history={this.state.history}\r\n                    activePanel={this.state.activePanel}\r\n                >\r\n                    <Panel id='main'>\r\n                        <PanelHeader>Ошибка</PanelHeader>\r\n                        <div>{error.message}</div>\r\n                    </Panel>\r\n                </View>\r\n            );}\r\n        else if (!isLoaded) {\r\n            return (\r\n                <View\r\n                    onSwipeBack={this.goBack}\r\n                    history={this.state.history}\r\n                    activePanel={this.state.activePanel}\r\n                >\r\n                    <Panel id='main'>\r\n                        <PanelHeader>Загрузка...</PanelHeader>\r\n                    </Panel>\r\n                </View>\r\n            );}\r\n        else {\r\n            return (\r\n                <View \r\n\t\t\t\t\tonSwipeBack={this.goBack}\r\n\t\t\t\t\thistory={this.state.history}\r\n\t\t\t\t\tactivePanel={this.state.activePanel}\r\n\t\t\t\t>\r\n                    <Panel id='main'>\r\n                        <h1>Ok</h1>\r\n                    </Panel>\r\n                </View>\r\n            );\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport default App;","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport App from \"./App\";\n\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\");\n\nReactDOM.render(<App />, document.getElementById(\"root\"));"],"sourceRoot":""}